<!DOCTYPE html>
<html>
<head>
<title>Marauder's Map</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="style.css" />
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA-i35yb5RVEpG1g4mPBM71eHeHrIGLRjw">
</script>
<script>

/* SEND MY LOCATION */
        function initialize() {
        navigator.geolocation.getCurrentPosition(function(position) {
            lat = position.coords.latitude;
            lng = position.coords.longitude;
        
            var mapOptions = {
                center: { lat: position.coords.latitude, lng: position.coords.longitude},
                zoom: 13
            };
            getData(lat, lng);
            map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions)
            });
        }
        google.maps.event.addDomListener(window, "load", initialize);
        
    function getData(lat, lng) {
        xhr = new XMLHttpRequest();
        xhr.open("post", "http://chickenofthesea.herokuapp.com/sendLocation", true);
        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function() {
                if (xhr.readyState == 4) {
//                         console.log(xhr.responseText);
                        var txt = document.getElementById("distances");
                        chars = JSON.parse(xhr.responseText);
                        txt.innerHTML = chars;
                        printChars(chars);
                }
        }
        xhr.send("login=HannahAbbott&lat=" + lat + "&lng=" + lng);
    }
    
    function printChars(chars) {
        var txt = document.getElementById("distances");
        for (i = 0; chars['characters'][i]; i++) {
            console.log(chars['characters'][i]['name']);
        }
        for (i = 0; chars['students'][i]; i++) {
            console.log(chars['students'][i]['login']);
        }
    }
    
</script>
</head>

<body>
    <div id="map-canvas"></div>
    <div id="distances"></div>
</body>
</html>